<div class="w-full flex align-items-center justify-content-center">
    <div class="w-10 px-5 py-5 border-round-right-lg shadow-7" style="height: 80%;">
        <div class="flex align-items-center justify-content-center my-1 primary-300">
        </div>
        <div class="flex w-12 py-5 flex-row align-items-center justify-content-center">
            <p-button class="px-5" (onClick)="verEstadisticas()" icon="pi pi-database" label="Estadisticas"></p-button>
            <p-button class="px-5" (onClick)="verGrafico()" icon="pi pi-chart-bar" severity="success" label="Grafico"></p-button>
        </div>

        <div class="flex w-12 py-1 flex-row align-items-center justify-content-center">
            <p-dropdown 
            [options]="options" 
            [(ngModel)]="selectedOption" 
            optionLabel="name"
            (onChange)="changeOption()"
            placeholder="Selecciona un dato" />
        </div>

        @if( selectedOption && selectedOption.value > 3 && selectedOption.value < 6) {
            <div class="flex w-12 py-5 flex-row align-items-center justify-content-center">
                <p-calendar 
                [(ngModel)]="rangeDates"
                (onClose)="changeOption()"
                selectionMode="range" 
                [readonlyInput]="true" />

            </div>
        }
        @if (selectedOption && selectedOption.value === 10) {

            <div class="flex w-12 py-1 flex-row align-items-center justify-content-center">
                <p-dropdown 
                  [options]="pacientes" 
                  [(ngModel)]="selectedPaciente" 
                  optionLabel="nombre"
                  (onChange)="changeOption()"
                  placeholder="Selecciona un paciente" >
                  <ng-template let-paciente pTemplate="patientTemplate">
                    <div class="flex align-items-center">
                      <img [src]="paciente.imagenPerfil" alt="Imagen de perfil" width="32" height="32" class="mr-2" />
                      <span>{{paciente.nombre}} {{paciente.apellido}}</span>
                    </div>
                  </ng-template>
                </p-dropdown>
          
            </div>
        }
        <div class="flex justify-content-center">
            @if ((selectedOption && selectedOption.value != 10) || selectedPaciente) {
                @if(selectedView == 'grafico') {
                    <div class="w-6">
                        <canvas id="chart"> {{ chart }} </canvas>
                        <div class="w-12 flex justify-content-end py-2">
                            <p-button class="px-3" (onClick)="generateImage()" icon="pi pi-image" severity="primary" label="Exportar Imagen"></p-button>
                            <p-button class="px-3" (onClick)="generatePdf()" icon="pi pi-file-pdf" severity="danger" label="Exportar"></p-button>
                        </div>
                    </div>
                }
                @else {
                    <div class="w-full">
                        <p-table [tableStyle]="{ 'overflow': 'auto' }" [styleClass]="'small'" [value]="getKeys()" [tableStyle]="{ 'min-width': '50rem' }">
                            <ng-template pTemplate="header">
                                <tr>
                                    <th>
                                        Campo
                                    </th>
                                    <th>
                                        Cantidad
                                    </th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-key>
                                <tr>
                                    <td>{{key}}</td>
                                    <td appStatNumber [number]="data[key]"> {{data[key]}} </td>
                                </tr>
                            </ng-template>
                        </p-table>
                        <div class="w-12 flex justify-content-end py-2">
                            <p-button (onClick)="generateExcel()" icon="pi pi-file-excel" severity="success" label="Exportar"></p-button>
                        </div>
                    </div>
                }
            }
        </div>
        
    </div>
</div>